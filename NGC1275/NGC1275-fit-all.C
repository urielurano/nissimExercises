
{
 gROOT->Reset();

 c1=new TCanvas ("c1", "",20,1,640,480);
 TMultiGraph *mg = new TMultiGraph();
 mg->SetTitle(";E(eV); E^{2}dN/dE (MeV cm^{-2} s^{-1})");
 c1->SetFillColor(10);
 c1->GetFrame()->SetFillColor(25);
 c1->GetFrame()->SetBorderSize(20);
 

 Int_t n=128;//unkonwn
 Int_t i;
 Float_t w[n]={2.56370000e-06,   2.72910000e-06,   4.54850000e-06,
         5.78900000e-06,   3.92825000e-06,   5.78900000e-06,
         5.78900000e-06,   2.06750000e-05,   8.27000000e-06,
         2.06750000e-05,   2.06750000e-05,   2.97720000e-05,
         2.97720000e-05,   2.97720000e-05,   6.20250000e-05,
         7.44300000e-05,   8.68350000e-05,   8.68350000e-05,
         1.24050000e-04,   1.24050000e-04,   1.65400000e-04,
         2.06750000e-04,   2.48100000e-04,   2.48100000e-04,
         4.05230000e-04,   1.65400000e-03,   1.57130000e-03,
         7.44300000e-03,   9.51050000e-03,   9.51050000e-03,
         1.24050000e-01,   3.63880000e-01,   8.27000000e-01,
         1.24050000e+00,   1.65400000e+00,   2.23290000e-02,
         2.23290000e-02,   2.23290000e-02,   2.23290000e-02,
         1.65400000e+00,   1.57130000e+00,   1.44725000e+00,
         1.40590000e+00,   8.68350000e-01,   8.68350000e-01,
         8.68350000e-01,   2.89450000e+00,   2.68775000e+00,
         3.10125000e+00,   3.34935000e+00,   2.48100000e+00,
         2.48100000e+00,   2.56370000e+00,   2.39830000e+00,
         2.60505000e+00,   2.56370000e+00,   2.39830000e+00,
         2.52235000e+00,   2.35695000e+00,   2.27425000e+00,
         1.36455000e+00,   1.44725000e+00,   1.52995000e+00,
         1.61265000e+00,   1.65400000e+00,   1.77805000e+00,
         1.03375000e+00,   1.07510000e+00,   1.15780000e+00,
         1.19915000e+00,   1.36455000e+00,   1.44725000e+00,
         1.52995000e+00,   1.61265000e+00,   1.65400000e+00,
         1.77805000e+00,   1.03375000e+00,   1.07510000e+00,
         1.15780000e+00,   1.19915000e+00,   3.92825000e-02,
         3.92825000e-02,   9.09700000e-02,   9.09700000e-02,
         9.09700000e-02,   9.09700000e-02,   9.09700000e-02,
         2.06750000e-01,   1.86075000e-01,   2.27425000e-01,
         2.06750000e-01,   2.15020000e-01,   4.05230000e-02,
         4.05230000e-02,   4.05230000e-02,   4.05230000e-02,
         4.01095000e-01,   4.13500000e-01,   6.61600000e-01,
         8.68350000e-01,   4.01095000e-01,   4.13500000e-01,
         1.32320000e-01,   1.73670000e-01, 9.5105000000000005e-05,4.34175000e-06,   1.65400000e-05,   2.89450000e-05,
         3.59745000e-05,   8.68350000e-05,   1.48860000e-04,2.4810000000000003,2.8945 ,  3.308  ,  3.51475,  4.5485 ,  7.443  ,  9.5105,3.39070000e+08,   4.96200000e+08,   1.24050000e+09,
         2.68775000e+09,   4.13500000e+09,   1.24050000e+10,
         2.48100000e+10, 1e11, 1.9e11, 3.8e11};//x
 Float_t v[n]={4.12500000e-08,   4.50000000e-08,   8.75000000e-08,
         8.75000000e-08,   1.06250000e-07,   1.12500000e-07,
         1.18750000e-07,   1.68750000e-07,   1.93750000e-07,
         4.12500000e-07,   4.25000000e-07,   5.62500000e-07,
         1.37500000e-06,   1.62500000e-06,   2.62500000e-06,
         3.37500000e-06,   4.25000000e-06,   4.50000000e-06,
         5.25000000e-06,   5.62500000e-06,   7.50000000e-06,
         8.75000000e-06,   1.00000000e-05,   1.12500000e-05,
         1.75000000e-05,   3.81250000e-05,   3.12500000e-05,
         2.62500000e-05,   5.00000000e-05,   5.93750000e-05,
         2.81250000e-05,   3.00000000e-05,   3.50000000e-05,
         3.75000000e-05,   4.06250000e-05,   1.37500000e-04,
         1.56250000e-04,   1.75000000e-04,   1.81250000e-04,
         5.25000000e-04,   4.75000000e-04,   4.56250000e-04,
         3.81250000e-04,   3.18750000e-04,   2.87500000e-04,
         2.50000000e-04,   4.68750000e-05,   4.37500000e-05,
         3.75000000e-05,   3.18750000e-05,   6.87500000e-05,
         8.12500000e-05,   9.37500000e-05,   1.12500000e-04,
         1.18750000e-04,   1.31250000e-04,   1.43750000e-04,
         1.50000000e-04,   1.56250000e-04,   1.62500000e-04,
         1.56250000e-04,   1.62500000e-04,   1.56250000e-04,
         1.62500000e-04,   6.90625000e-05,   7.18750000e-05,
         7.53125000e-05,   7.81250000e-05,   8.15625000e-05,
         8.43750000e-05,   7.81250000e-05,   7.53125000e-05,
         1.15625000e-04,   1.16875000e-04,   1.21875000e-04,
         1.34375000e-04,   1.37812500e-04,   1.34375000e-04,
         1.44062500e-04,   1.53125000e-04,   1.46875000e-04,
         1.50312500e-04,   2.19062500e-04,   2.44062500e-04,
         2.50312500e-04,   2.81562500e-04,   3.06562500e-04,
         2.18750000e-04,   2.23125000e-04,   1.90625000e-04,
         1.78125000e-04,   1.50312500e-04,   2.19062500e-04,
         2.44062500e-04,   2.50312500e-04,   2.56562500e-04,
         6.90625000e-05,   7.18750000e-05,   7.53125000e-05,
         7.81250000e-05,   1.31562500e-04,   1.46875000e-04,
         6.12500000e-05,   4.87500000e-05, 1.3124999999999999e-06,1.18750000e-07,   2.62500000e-07,   4.43750000e-07,
         9.37500000e-07,   1.25000000e-06,   2.12500000e-06,5.3125000000000004e-05,4.37500000e-05,   3.75000000e-05,   3.12500000e-05,
         2.56250000e-05,   2.81250000e-05,   2.68750000e-05, 1.87500000e-05,   2.00000000e-05,   1.75000000e-05,
         1.56250000e-05,   1.15625000e-05,   1.00000000e-05,
         8.12500000e-06, 3.8e-6,6.8e-7,3.7e-7};//y,
 Float_t ewl[n]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 Float_t evl[n]={0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   2.18750000e-08,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         2.31250000e-07,   2.93750000e-07,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   1.37500000e-07,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   1.25000000e-05,
         0.00000000e+00,   1.25000000e-05,   1.87500000e-05,
         6.25000000e-06,   6.25000000e-06,   6.25000000e-06,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         4.50000000e-05,   4.50000000e-05,   4.50000000e-05,
         7.50000000e-05,   7.50000000e-05,   7.50000000e-05,
         7.50000000e-05,   7.50000000e-05,   7.50000000e-05,
         7.50000000e-05,   7.50000000e-06,   7.50000000e-06,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   1.87500000e-05,
         1.87500000e-05,   1.87500000e-05,   1.87500000e-05,
         1.87500000e-05,   1.87500000e-05,   1.87500000e-05,
         1.87500000e-05,   1.87500000e-05,   1.87500000e-05,
         1.87500000e-05,   1.87500000e-05,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,1.87500000e-07,   2.00000000e-07,   1.75000000e-07,
         5.56250000e-06,   4.15625000e-06,   5.00000000e-06,
         5.82500000e-06, 1.0e-6,4.8e-7,3.1e-7};
 Float_t ewh[n]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 Float_t evh[n]={0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   2.18750000e-08,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         2.31250000e-07,   2.93750000e-07,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   1.37500000e-07,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   1.25000000e-05,
         0.00000000e+00,   1.25000000e-05,   1.87500000e-05,
         6.25000000e-06,   6.25000000e-06,   6.25000000e-06,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         4.50000000e-05,   4.50000000e-05,   4.50000000e-05,
         7.50000000e-05,   7.50000000e-05,   7.50000000e-05,
         7.50000000e-05,   7.50000000e-05,   7.50000000e-05,
         7.50000000e-05,   7.50000000e-06,   7.50000000e-06,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   1.87500000e-05,
         1.87500000e-05,   1.87500000e-05,   1.87500000e-05,
         1.87500000e-05,   1.87500000e-05,   1.87500000e-05,
         1.87500000e-05,   1.87500000e-05,   1.87500000e-05,
         1.87500000e-05,   1.87500000e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.87500000e-07,   2.00000000e-07,   1.75000000e-07,
         5.56250000e-06,   4.15625000e-06,   5.00000000e-06,
         5.82500000e-06, 1.8e-6,4.8e-7,3.1e-7};
 gr=new TGraphAsymmErrors(n,w,v,ewl,ewh,evl,evh);
 gr->SetMarkerColor();
 gr->SetMarkerStyle(8);
 gr->SetMarkerSize(0.7);  
 gr->SetLineColor(1); 
 
 gr->SetLineStyle(1);  
 gPad->SetLogy();  
 gPad->SetLogx();


 






//Swift y HST ponen puntos raros.
 Int_t n3=6;//Swift/UVOT
 Int_t i;
 Float_t w3[n3]={2.8945 ,  3.308  ,  3.51475,  4.5485 ,  7.443  ,  9.5105};
 Float_t v3[n3]={4.37500000e-05,   3.75000000e-05,   3.12500000e-05,
         2.56250000e-05,   2.81250000e-05,   2.68750000e-05};
 Float_t ewl3[n3]={0,0,0,0,0,0};
 Float_t evl3[n3]={0,0,0,0,0,0};
 Float_t ewh3[n3]={0,0,0,0,0,0};
 Float_t evh3[n3]={0,0,0,0,0,0};
 gr3=new TGraphAsymmErrors(n3,w3,v3,ewl3,ewh3,evl3,evh3);
 gr3->SetMarkerColor(kMagenta-4);
 gr3->SetMarkerStyle(4);
 gr3->SetMarkerSize(1.7);  
  gPad->SetLogy();  
 gPad->SetLogx();
 gr3->SetFillColor(2); 



 Int_t n9=14;//HST-optical-UV
 Int_t i;
 Float_t w9[n9]={6.2e-12,2.07e-11,6.21e-11,3.73e-10,8.28e-10,1.863e-8,5.382e-8,1.242e-7,2.484e-6,3.519e-6,4.968e-6,8.28e-6,8.28e-6,1.035e-5};//x
 Float_t v9[n9]={0.000000034,0.000000112,0.00000028,0.000001123,0.0000021916,0.00000714,0.000004056,0.000002995,0.000003868,0.000002371,0.000001248,0.000000911,0.000001123,0.000003496};//y
 Float_t ewl9[n9]={0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 Float_t evl9[n9]={0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 Float_t ewh9[n9]={0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 Float_t evh9[n9]={0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 gr9=new TGraphAsymmErrors(n9,w9,v9,ewl9,ewh9,evl9,evh9);
 gr9->SetMarkerColor();
 gr9->SetMarkerStyle(8);
 gr9->SetMarkerSize(0.75);
 gr9->SetLineColor(2);
 gPad->SetLogy();
 gPad->SetLogx();


 Int_t n10=4;//CHANDRA-core-X
 Int_t i;
 Float_t w10[n10]={5.55e-11,8.28e-4,1.242e-3,2.726e-3};
 Float_t v10[n10]={1.06e-7,3.74e-7,4.05e-7,4.36e-7};
 Float_t ewl10[n10]={0,0,0,0};
 Float_t evl10[n10]={0,0,0,0};
 Float_t ewh10[n10]={0,0,0,0};
 Float_t evh10[n10]={0,0,0,0};
 gr10=new TGraphAsymmErrors(n10,w10,v10,ewl10,ewh10,evl10,evh10);
 gr10->SetMarkerColor(kRed+0);
 gr10->SetMarkerStyle(8);
 gr10->SetMarkerSize(0.9);  
 gr10->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr10->SetFillColor(2); 


 Int_t n11=3;//SWIFT-BAT-X
 Int_t i;
 Float_t w11[n11]={3.484e-2,5.796e-2,1.449e-1};
 Float_t v11[n11]={1.435e-6,1.996e-6,1.123e-5};
 Float_t ewl11[n11]={0,0,0};
 Float_t evl11[n11]={0,0,0};
 Float_t ewh11[n11]={0,0,0};
 Float_t evh11[n11]={0,0,0};
 gr11=new TGraphAsymmErrors(n11,w11,v11,ewl11,ewh11,evl11,evh11);
 gr11->SetMarkerColor(kRed-8);
 gr11->SetMarkerStyle(23);
 gr11->SetMarkerSize(0.87);  
 gr11->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr11->SetFillColor(2); 


 
 Int_t n20=2;//end
 Int_t i;
 Float_t w20[n20]={9.484e13,1.796e13};
 Float_t v20[n20]={1.435e-9,1.996e-9};
 Float_t ewl20[n20]={0,0};
 Float_t evl20[n20]={0,0};
 Float_t ewh20[n20]={0,0};
 Float_t evh20[n20]={0,0};
 gr20=new TGraphAsymmErrors(n20,w20,v20,ewl20,ewh20,evl20,evh20);
 gr20->SetMarkerColor();
 gr20->SetMarkerStyle(8);
 gr20->SetMarkerSize(0.0001);  
 gr20->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr20->SetFillColor(2); 

 Int_t n21=2;//beginning
 Int_t i;
 Float_t w21[n21]={2.484e-9,5.796e-9};
 Float_t v21[n21]={1.435e-9,1.996e-9};
 Float_t ewl21[n21]={0,0};
 Float_t evl21[n21]={0,0};
 Float_t ewh21[n21]={0,0};
 Float_t evh21[n21]={0,0};
 gr21=new TGraphAsymmErrors(n21,w21,v21,ewl21,ewh21,evl21,evh21);
 gr21->SetMarkerColor();
 gr21->SetMarkerStyle(8);
 gr21->SetMarkerSize(0.0001);  
 gr21->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr21->SetFillColor(2); 






  mg->Add(gr);
 
  mg->Add(gr20);
 mg->Add(gr21);
 
 mg->Draw("apz");



 TLegend *legend = new TLegend(0.6,0.6,0.92,0.98);
 legend->SetFillColor(0);
 //legend->SetFillAttributes(14);
 legend->SetBorderSize(1.0);
 legend->AddEntry(gr,"ROSAT","p");
 //legend->SetTextAlign(12);
 // legend->AddEntry(gr4,"Magic","p");
 //legend->AddEntry(gr9,"HST-optical-UV","p");
 //legend->AddEntry(gr10,"CHANDRA-core-X","p");
 //legend->AddEntry(gr11,"SWIFT-BAT-X-limit","p");
 legend->Draw();

//############################Fit formulas###############
//################
//##############################################################
//
 //fun2 = new TF1("fun2"," [0]*((0.1e12/0.1e12)^(-1)*(x/0.1e12)**(3-[1])*(x>=0.06e12)*(x<0.1e12)+((x/0.1e12)**(2-[1])*(x>=0.1e12)*(x<5e13)))",1E11,7E14); //pgamma interaction
 //Estos son los parámetros de normalización:
Float_t aa = 0.00004;
Float_t bb = 10;
Float_t cc = 10;
 //fun4 = new TF1("fun4"," [0]*(((1e-1/0.00004)^(-0.5)*(x/0.00004)^(4/3)*(5e-4/0.00004)**((3-[1])/2)*(x>1e-6)*(x<5e-4))+((1e-1/15)^(-0.5)*(x/15)**((3-[1])/2)*(x>=5e-4)*(x<1e-1)) + ((x/14)**((2-[1])/2))*(x>=1e-1)*(x<10))", 1e-6,100); //pgamma interaction
 //fun4 = new TF1("fun4"," [0]*(((1e-1/[2])^(-0.5)*(x/[2])^(4/3)*(5e-4/[2])**((3-[1])/2)*(x>1e-6)*(x<[2])+((1e-1/[3])^(-0.5)*(x/[3])**((3-[1])/2)*(x>=[2])*(x<[3])) + ((x/[4])**((2-[1])/2))*(x>=[3])*(x<[4])",  1e-6,100); //pgamma interaction
 fun4 = new TF1("fun4"," [0]*((x/[2])^(4/3)*(x>1e-6)*(x<[2])+((x/[2])**((3-[1])/2)*(x>=[2])*(x<[3])) + ((x/[2])**((3-[1])/2))*((x/[3])**((2-[1])/2))*(x>=[3])*(x<1e2)) + [4]*((x/[5])^(4/3)*(x>1e4)*(x<[5])+((x/[5])**((3-[1])/2)*(x>=[5])*(x<[6])) + ((x/[5])**((3-[1])/2))*((x/[6])**((2-[1])/2))*(x>=[6])) + [7]*((0.1e12/0.1e12)^(-1)*(x/0.1e12)**(3-[1])*(x>=0.06e12)*(x<0.1e12)+((x/0.1e12)**(2-[1])*(x>=0.1e12)*(x<5e13)))",  1e-6,1e14); //pgamma interaction
 // Se fija el valor inicial de los parámetros:
  fun4->SetParameter(1,2.5);
  fun4->SetParLimits(1,2.5,2.5);
  fun4->SetParameter(2,1e-4);
  fun4->SetParLimits(2,1e-5,1e-3);
  fun4->SetParameter(3,1);
  fun4->SetParLimits(3,1e-1,1e+1);
  fun4->SetParameter(5,5e6);
  fun4->SetParLimits(5,1e5,5e7);
  fun4->SetParameter(6,1e9);
  fun4->SetParLimits(6,1e8,1e10);
// fun3 = new TF1("fun3","[0]*(x/1e12)^(2-[1])",1e+11,1e+13); //pp interaction
 
//#################fit commands############
//####################################
//###############
//
//
//((1e-1/1)^(-0.5)*(x/1)^(4/3)*(1e-4/1)**((3-[1])/2)*(x>1e-6)*(x<1e-4))

 fun4->SetLineWidth(2);
  gr->Fit("fun4","APL+"); 
 // gr4->Fit("fun3","APL+"); 
 }


